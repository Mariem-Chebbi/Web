{% extends 'base_back.html.twig' %}

{% block body %}
<li class="active">
                        <a href="{{path('app_addUser')}}"><i class="fa fa-diamond"></i> <span class="nav-label">Utilisateures</span></a>
                    </li>
                    
                    

                     <li>
                        <a href="#"><i class="fa fa-shopping-cart"></i> <span class="nav-label">Blogs</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                        <li><a href="{{path('app_addBlog')}}">Blogs </a></li>
                            <li><a href="{{path('app_addCategorie')}}">Categorie</a></li>
                            </ul>
                    </li>

                    <li>
                        <a href="#"><i class="fa fa-diamond"></i> <span class="nav-label">Formations/Certifs</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                        <li><a href="{{path('app_addFormation')}}">Formations </a></li>
                            <li><a href="{{path('app_addCertification')}}">Certifications</a></li>
                            </ul>
                    </li>

                    <li>
                        <a href="#"><i class="fa fa-shopping-cart"></i> <span class="nav-label">Produits/Reservations</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                        <li><a href="{{path('app_addProduct')}}">Produits </a></li>
                            <li><a href="{{path('app_addReservation')}}">Reservations</a></li>
                            </ul>
                    </li>

                    <li>
                        <a href="#"><i class="fa fa-shopping-cart"></i> <span class="nav-label">Centres/Services</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                        <li><a href="{{path('app_addCentre')}}">Centres </a></li>
                            <li><a href="{{path('app_addServices')}}">Services</a></li>
                            </ul>
                    </li>

                    <li>
                        <a href="#"><i class="fa fa-diamond"></i> <span class="nav-label">Evenements</span><span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level collapse">
                        <li><a href="{{path('app_evenement_index')}}">Evenements </a></li>
                            <li><a href="{{path('app_sponsor_index')}}">Sponsers</a></li>
                            </ul>
                    </li>

                </ul>

            </div>
        </nav>

        <div id="page-wrapper" class="gray-bg dashbard-1">
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
            <form role="search" class="navbar-form-custom" action="search_results.html">
                <div class="form-group">
                    <input type="text" placeholder="Rechercher..." class="form-control" name="top-search" id="top-search">
                </div>
            </form>
        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <span class="m-r-sm text-muted welcome-message">Bienvenue dans Edusex Admin Dashboard</span>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-envelope"></i>  <span class="label label-warning">16</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages">
                        <li class="divider"></li>
                        <li>
                            <div class="text-center link-block">
                                <a href="mailbox.html">
                                    <i class="fa fa-envelope"></i> <strong>Read All Messages</strong>
                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell"></i>  <span class="label label-primary">8</span>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">     
                    </ul>
                </li>
                <li>
                    <a href="{{path('app_register')}}">
                        <i class="fa fa-sign-out"></i> Déconnecter
                    </a>
                </li>
                <li>
                    <a class="right-sidebar-toggle">
                        <i class="fa fa-tasks"></i>
                    </a>
                </li>
            </ul>
        </nav>
        </div>
        {% for message in app.flashes('success') %}
                         <div class="alert alert-success">
                             {{ message }}
                        </div>
                    {% endfor %}
                    {% for message in app.flashes('error') %}
                         <div class="alert alert-danger">
                             {{ message }}
                        </div>
                    {% endfor %}
                    
                <div class="row  border-bottom white-bg dashboard-header"> 





    <section class="contact-us" id="contact-section">

        <div class="container d-flex flex-column justify-content-center align-items-center" style="height: 100vh;">

            <style>
                h1.text-primary {
                    color: #1ab394;;
                    font-size: 28px;
                    text-align: center; /* Centrer le titre */
                    text-transform: uppercase; /* Mettre le texte en majuscules */
                    letter-spacing: 2px; /* Ajouter de l'espace entre les lettres */
                    font-weight: bold; /* Mettre en gras */
                    text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.3); /* Ajouter une ombre au texte */
                }

                .roles-inline label {
                    display: inline-block;
                    margin-right: 10px;
                / / adjust the spacing between the choices
                }

                button {
                    background-color: #1ab394;
                    border-color: #1ab394;
                    color: #1ab394;
                    padding: 5px 10px;
                    font-size: 14px;
                    font-weight: 400;
                    line-height: 1.5;
                    border-radius: 3px;
                }

                table {
                    border-collapse: collapse;
                    width: 100%;
                    max-width: 100%;
                    margin-bottom: 1rem;
                    background-color: #fff;
                    border: 1px solid #1ab394;
                }

                th,
                td {
                    padding: 0.75rem;
                    vertical-align: top;
                    border-top: 1px solid #1ab394;
                }

                th {
                    vertical-align: bottom;
                    border-bottom: 2px solid #1ab394;
                    background-color: #f2f2f2;
                }

                td {
                    background-color: transparent;
                }

                tr:nth-child(even) td {
                    background-color: #f9f9f9;
                }

                title {
                    text-align: right;
                }
            </style>

            <div class="container" style="margin-top: 70px;">
                <label for="search"></label>
                <div class="col-md-8 mx-auto">
                    <div class="row ">
                        <input type="text" id="search"
                               class="col-md-10 my-3 form-control rounded registration-input-box"
                               placeholder="Recherche un utilisateur ...">
                        <div class="col-md-2 my-3 sort-button text-center float-sm-right">
                            <ul class="list-unstyled mb-0">
                                <li class="list-inline-item mb-0 mr-5 shadow-sm">
                                    <select id="sort-select" class="p-2">
                                        <option value="" disabled selected>Trier par ..</option>
                                        <option value="0">Pas de tri</option>
                                        <option value="1">Email</option>
                                        <option value="2">Nom</option>
                                        <option value="3">Prenom</option>
                                    </select>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="ibox-content">
                    <div style="">
                        <div class="card">
                            <div class="card-body">
                                <center><h1 class="text-center mb-4 mt-0 text-primary">Liste des utilisateurs</h1>
                                </center>
                            </div>

                            <form>
                                        Recheche par date :
                                        <input type="text" id="search-input">
                                    </form>

                            <table id="search-results" >
                                <tr>
                                    <th>Id</th>
                                    <th>Email</th>
                                    <th>Roles</th>
                                    <th>Nom</th>
                                    <th>Prénom</th>
                                    <th>Numéro de téléphone</th>
                                    <th>Ville</th>
                                    <th>Date de naissance</th>
                                    <th>Image</th>
                                    <th>Action</th>
                                </tr>
                                <tbody id="table-body">
                                {% for i in User %}
                                    <tr>
                                        <td>{{ i.id }}</td>
                                        <td>{{ i.email }}</td>
                                        <td class="roles-inline">{{ i.roles ? i.roles|json_encode : '' }}</td>
                                        <td>{{ i.nom }}</td>
                                        <td>{{ i.prenom }}</td>
                                        <td>{{ i.numTel }}</td>
                                        <td>{{ i.ville }}</td>
                                        <td>{{ i.DateNaissance|date('Y-m-d') }}</td>
                                        <td><img src="{{ asset('images/' ~ i.image) }}"
                                                 style="width: 50px; height: auto;"/></td>
                                        <td>
                                            <div>
                                                <a href="{{ path('supprimerU', {'id': i.id}) }}"
                                                   class="main-button-gradient">Supprimer</a><br>
                                            </div>
                                            <div>
                                                <a href="{{ path('updatU', {'id': i.id}) }}"
                                                   class="main-button-gradient">Modifier</a>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                                <tbody id="table-body-search">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        const searchInput = document.querySelector('#search-input');
        const searchResults = document.querySelector('#search-results tbody');

        searchInput.addEventListener('input', () => {
            const query = searchInput.value;

            fetch(`/rdv/search/${query}`)
                .then(response => response.json())
                .then(data => {
                    searchResults.innerHTML = '';

                    data.forEach(rdv => {
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>" + user.id + "</td>" +
                                                "   <td>" + user.email + "</td>" +
                                                "   <td>" + user.roles + "</td>" +
                                                "   <td>" + user.nom + "</td>" +
                                                "   <td>" + user.prenom + "</td>" +
                                                "   <td>" + user.numTel + "</td>" +
                                                "   <td>" + user.ville + "</td>" +
                                                "   <td>" + user.DateNaissance + "</td>"
                        `;
                        searchResults.appendChild(tr);
                    });
                });
        });
    </script>
    {% endblock %}