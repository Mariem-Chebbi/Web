{% extends 'base_front.html.twig' %}
{% block body %}
<style>
.bg-success-light {
  background-color: #d1e7dd;
  width: 100%;
}
.bg-warning-light {
  background-color: #fff3cd;
}
.bg-danger-light {
  background-color: #f8d7da;
  width: 100%;
}


    
</style>

<script>

const searchInput = document.querySelector('#search-input');
const searchResults = document.querySelector('#search-results');

searchInput.addEventListener('input', () => {
    const query = searchInput.value.trim();

    if (query.length < 2) {
        return;
    }

    const xhr = new XMLHttpRequest();

    xhr.onreadystatechange = () => {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
                const products = JSON.parse(xhr.responseText);

                searchResults.innerHTML = '';

                if (products.length === 0) {
                    searchResults.innerHTML = '<p>Aucun résultat trouvé.</p>';
                } else {
                    const ul = document.createElement('ul');

                    products.forEach((product) => {
                        const li = document.createElement('li');
                        li.innerHTML = `${product.libelle} - ${product.prix} €`;
                        ul.appendChild(li);
                    });

                    searchResults.appendChild(ul);
                }
            } else {
                console.error(xhr.statusText);
            }
        }
    };

    xhr.open('GET', `/search-products?query=${query}`);
    xhr.send();
});

</script>




<section class="services" id="services">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="section-heading">
        
            <h4>Nos <em>Produits</em></h4>
          </div>
          {% for message in app.flashes('success') %}
                         <div class="alert alert-success">
                             {{ message }}
                        </div>
                    {% endfor %}
        </div>
        
        <div class="col-lg-12">
          <div class="owl-service-item owl-carousel">
          


          

          {% for i in Products %}
            <div class="item">
              <div class="service-item">
              {% if i.quantite == 0 %}
              {# <a style="color: red;">hors stock</a> #}
              <span class="badge badge-pill bg-danger-light" style="color: #ed5565;width: 100%;">hors stock</span>
              
              {% elseif i.quantite < 6 %}
              {# <a style="color: red;">hors stock</a> #}
              <span class="badge badge-pill bg-warning-light" style="color: #664d03;width: 100%;">stock limité</span>
              {% else %}
              {# <a style="color: green;">en stock</a> #}
              <span class="badge badge-pill bg-success-light" style="color: #3c763d;width: 100%;">en stock</span>
              {% endif %}
                <div>
                  <img src= "{{ asset('images/' ~ i.image) }}" style="width: 100%; height: auto;" />
                </div>
                <h4>{{i.libelle}}</h4>
                <p>{{i.description|slice(0, 75) ~ '...' }}</p><br>
                <a href="{{path('afficheDetailsP',{'id':i.id}) }}" class="btn btn-white">plus de details</a><br><br>
                {# {% if app.user %}
                  {% if i.isFavorite(app.user) %}
                      <a href="{{ path('favorite_remove', {'id': i.getFavorite(app.user).getId()}) }}" class="btn btn-danger">Remove from favorites</a>
                  {% else %}
                      <a href="{{ path('favorite_add', {'id': i.getId()}) }}" class="btn btn-warning">Add to favorites</a>
                  {% endif %}
              {% endif %} #}
              </div>
            </div>
            {% endfor %}

          </div>
        </div>



      </div>
    </div>

</section>
<section class="our-courses" id="courses">
<div class="container">
    
      <div class="row">
        <div class="col-lg-6 offset-lg-3">
          <div class="section-heading">
            
           
            
            {# <p>You just think about TemplateMo whenever you need free CSS templates for your business website</p> #}
          </div>
        </div>

        <div>
     

    
         {# {% include "formation/showFormation.html.twig" with {"Formation": Formation} %}   #}
    </div>
  


        </div><br></br>

        <div class="col-lg-12">
          <div class="naccs">
            <div class="tabs">
              <div class="row">
               
<div>
    
    
    


                <div class="col-lg-10">
                  <ul class="nacc">
                  <form id="search-form">
     <input type="text" placeholder="Search here..." name ="q" id="search-input" style="width: 100%;"></form><br><br>
                  {# {% set sortedElements = elements| orderBy ('createdAt') %} #}
                  {% for i in Product %}
                    <li class="active">
                   {% if i.quantite == 0 %}
              {# <a style="color: red;">hors stock</a> #}
              <span class="badge badge-pill bg-danger-light" style="color: #ed5565;width: 100%;">hors stock</span>
              {% elseif i.quantite < 6 %}
              {# <a style="color: red;">hors stock</a> #}
              <span class="badge badge-pill bg-warning-light" style="color: #664d03;width: 100%;">stock limité</span>
              {% else %}
              {# <a style="color: green;">en stock</a> #}
              <span class="badge badge-pill bg-success-light" style="color: #3c763d;width: 100%;">en stock</span>
              {% endif %}
                      <div>
                      
                        <div class="left-image">
                          <img src= "{{ asset('images/' ~ i.image) }}" style="width: 250px; height: 250px;">
                          <div class="price"></div>
                        </div>
                        <div class="right-content">
                          <h4>{{i.libelle}}</h4>
                          <p>{{i.description|slice(0, 100) ~ '...'}}</p>
                          
                          {# <span>{{i.dateFormation|date('Y-m-d')}}</span> #}
                          <span class="last-span">
                          <a href="{{path('afficheDetailsP',{'id':i.id}) }}" class="btn btn-white">+ détails</a><br>
                          {# <a href="contact-us.html"></a> #}
                          </span><br>
                          <br>
                          <div></div>
                          
                          {# <a href="{{ path('inscription_formation', { 'id_personnel': 1 , 'id_formation': 24 }) }}">s'inscription</a></div>  #}
                          {# {% if app.user %}
                  {% if i.isInscription(app.user) %}
                      <a href="{{ path('inscription_remove', {'id': i.getInscriptions(app.user).getId()}) }}">✅</a>
                  {% else %}
                      <div class="main-button-gradient" style="width: 10px ; height: auto;">
                      <a href="{{ path('inscription_add', {'id': i.getId()}) }}">s'inscrire</a>
                  {% endif %}
              {% endif %} #}
                        </div>
                      </div>
                    </li><br>
                    {% endfor %}
                    {{ knp_pagination_render(Product) }}
                    </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="center">
        </div>
      </div>
    </div>


  



  </section>



{% endblock %}